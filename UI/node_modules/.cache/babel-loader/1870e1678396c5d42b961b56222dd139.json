{"ast":null,"code":"var _jsxFileName = \"/home/eelezi/thesis/rdf2resume/src/components/Dashboard/Forms/FormSubmit.jsx\";\nimport React, { Component } from \"react\";\nimport { Row, Col } from \"react-bootstrap\";\nimport CustomButton from \"../../core/CustomButton\";\nimport SubmitModal from \"./Modals/Submit/SubmitModal\";\nimport { toggleSpinner, updateError } from \"../../../actions/utilityActions\";\nimport Spinner from \"../../../components/core/Spinner\";\nimport { connect } from \"react-redux\";\nimport Swal from \"sweetalert2\";\nimport axios from \"axios\";\nimport { trackPromise } from \"react-promise-tracker\";\nimport { warningLabel, warningText, submitTitle, submitFirstButtonLabel, submitSecondButtonLabel, submitThirdButtonLabel, submitFourthButtonLabel } from \"../../../translations/translations\";\n\nclass FormSubmit extends Component {\n  constructor(props) {\n    super(props); // Create the ref\n\n    this.handleClose = () => {\n      let key = this.state.key;\n      this.setState({\n        showModal: false,\n        key: ++key\n      });\n    };\n\n    this.handleShow = () => {\n      let key = this.state.key;\n      this.setState({\n        showModal: true,\n        key: ++key\n      });\n    };\n\n    this.handleCloseEnriched = () => {\n      let key = this.state.key;\n      this.setState({\n        showModalEnriched: false,\n        key: ++key\n      });\n    };\n\n    this.handleShowEnriched = () => {\n      let key = this.state.key;\n      this.setState({\n        showModalEnriched: true,\n        key: ++key\n      });\n    };\n\n    this.checkError = data => {\n      let error = false;\n\n      if (data[\"my0:aboutPerson\"][\"my0:firstName\"] === \"\") {\n        this.props.updateError({\n          object: \"my0:firstName\",\n          value: true\n        });\n        error = true;\n      }\n\n      if (data[\"my0:aboutPerson\"][\"my0:lastName\"] === \"\") {\n        this.props.updateError({\n          object: \"my0:lastName\",\n          value: true\n        });\n        error = true;\n      }\n\n      if (data[\"my0:aboutPerson\"][\"my0:email\"] === \"\") {\n        this.props.updateError({\n          object: \"my0:email\",\n          value: true\n        });\n        error = true;\n      }\n\n      return error;\n    };\n\n    this.handleFormSubmit = async e => {\n      e.preventDefault();\n\n      if (this.checkError(this.props.cvData)) {\n        let lang = this.props.language;\n        Swal.fire({\n          title: warningLabel[lang],\n          text: warningText[lang],\n          type: \"warning\",\n          confirmButtonColor: \"#4bb3cc\",\n          heightAuto: false,\n          confirmButtonText: \"Okay\"\n        });\n      } else {\n        axios.post(\"/submit_form\", this.props.cvData).then(resp => {\n          this.setState({\n            jsonPath: \"../../static/\" + resp.data\n          });\n          this.anchorHiddenRef.click();\n        }).catch(error => {\n          console.log(error);\n        });\n      }\n    };\n\n    this.handlePDFgeneration = e => {\n      e.preventDefault();\n      this.handleShow();\n    };\n\n    this.handleShowPDF = async (designNumber, language) => {\n      if (this.checkError(this.props.cvData)) {\n        let lang = this.props.language;\n        Swal.fire({\n          title: warningLabel[lang],\n          text: warningText[lang],\n          type: \"warning\",\n          confirmButtonColor: \"#4bb3cc\",\n          heightAuto: false,\n          confirmButtonText: \"Okay\"\n        });\n      } else {\n        this.setState({\n          pdfPath: \"\"\n        });\n        this.setState({\n          showPDF: false\n        });\n        this.handleClose();\n        trackPromise(axios.post(\"/generate_pdf\", {\n          data: {\n            cv: this.props.cvData,\n            designNumber: designNumber,\n            language: language\n          }\n        }).then(resp => {\n          this.setState({\n            pdfPath: \"../../\" + resp.data\n          });\n          this.setState({\n            showPDF: true\n          });\n        }).catch(error => {\n          console.log(error);\n        }));\n      }\n    };\n\n    this.handleShowPDFEnriched = async (designNumber, language) => {\n      if (this.checkError(this.props.cvData)) {\n        let lang = this.props.language;\n        Swal.fire({\n          title: warningLabel[lang],\n          text: warningText[lang],\n          type: \"warning\",\n          confirmButtonColor: \"#4bb3cc\",\n          heightAuto: false,\n          confirmButtonText: \"Okay\"\n        });\n      } else {\n        this.setState({\n          pdfPath: \"\"\n        });\n        this.setState({\n          showPDF: false\n        });\n        this.handleCloseEnriched();\n        trackPromise(axios.post(\"/generate_pdf_enriched\", {\n          data: {\n            cv: this.props.cvData,\n            designNumber: designNumber,\n            language: language\n          }\n        }).then(resp => {\n          this.setState({\n            pdfPath: \"../../\" + resp.data\n          });\n          this.setState({\n            showPDF: true\n          });\n        }).catch(error => {\n          console.log(error);\n        }));\n      }\n    };\n\n    this.renderPDF = () => {\n      if (this.state.showPDF) {\n        return React.createElement(\"embed\", {\n          style: {\n            border: \"3px solid #4bb3cc\",\n            borderRadius: \"5px\"\n          },\n          src: this.state.pdfPath + \".pdf\",\n          width: \"800px\",\n          height: \"900px\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 203\n          },\n          __self: this\n        });\n      } else {\n        return \"\";\n      }\n    };\n\n    this.anchorHiddenRef = React.createRef();\n    this.state = {\n      showModal: false,\n      showModalEnriched: false,\n      key: 0,\n      showPDF: false,\n      pdfPath: \"\",\n      jsonPath: \"\"\n    };\n  }\n\n  render() {\n    let showModal = this.state.showModal;\n    let lang = this.props.language;\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, React.createElement(Row, {\n      style: {\n        alignItems: \"flex-start\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, React.createElement(Col, {\n      md: 4,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      style: {\n        marginTop: \"10px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, submitTitle[lang]), React.createElement(Row, {\n      style: {\n        justifyContent: \"left\",\n        marginLeft: 0\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, React.createElement(CustomButton, {\n      label: submitFirstButtonLabel[lang],\n      classnames: \"final-submit\",\n      handleClick: this.handleFormSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }), React.createElement(\"a\", {\n      ref: anchorHiddenRef => this.anchorHiddenRef = anchorHiddenRef,\n      href: this.state.jsonPath,\n      target: \"_blank\",\n      rel: \"noopener noreferrer\",\n      download: true,\n      hidden: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231\n      },\n      __self: this\n    }, \" \")), React.createElement(Row, {\n      style: {\n        justifyContent: \"left\",\n        marginLeft: 0\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(CustomButton, {\n      label: submitSecondButtonLabel[lang],\n      classnames: \"final-submit\",\n      handleClick: this.handleShow,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    })), React.createElement(SubmitModal, {\n      showPdf: this.handleShowPDF,\n      show: showModal,\n      key: this.state.key,\n      onHide: this.handleClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }), React.createElement(Row, {\n      style: {\n        justifyContent: \"left\",\n        marginLeft: 0\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, React.createElement(CustomButton, {\n      label: submitThirdButtonLabel[lang],\n      classnames: \"final-submit\",\n      handleClick: this.handleShowEnriched,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }), React.createElement(SubmitModal, {\n      showPdf: this.handleShowPDFEnriched,\n      show: this.state.showModalEnriched,\n      key: this.state.key,\n      onHide: this.handleCloseEnriched,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263\n      },\n      __self: this\n    })), React.createElement(Row, {\n      style: {\n        justifyContent: \"left\",\n        marginLeft: 0\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }, this.state.showPDF ? React.createElement(\"a\", {\n      className: \"final-submit btn btn-primary\",\n      style: {\n        marginTop: \"150px\"\n      },\n      href: this.state.pdfPath + \".tex\",\n      target: \"_blank\",\n      rel: \"noopener noreferrer\",\n      download: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }, submitFourthButtonLabel[lang]) : \"\")), React.createElement(Col, {\n      md: 8,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }, this.renderPDF())), React.createElement(Row, {\n      style: {\n        justifyContent: \"left\",\n        marginTop: \"10px\",\n        marginLeft: \"5px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, React.createElement(Spinner, {\n      show: this.props.showSpinner,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    })));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    cvData: state.cv,\n    language: state.utility.language,\n    showSpinner: state.utility.showSpinner,\n    error: state.utility.error\n  };\n};\n\nexport default connect(mapStateToProps, {\n  toggleSpinner,\n  updateError\n})(FormSubmit);","map":{"version":3,"sources":["/home/eelezi/thesis/rdf2resume/src/components/Dashboard/Forms/FormSubmit.jsx"],"names":["React","Component","Row","Col","CustomButton","SubmitModal","toggleSpinner","updateError","Spinner","connect","Swal","axios","trackPromise","warningLabel","warningText","submitTitle","submitFirstButtonLabel","submitSecondButtonLabel","submitThirdButtonLabel","submitFourthButtonLabel","FormSubmit","constructor","props","handleClose","key","state","setState","showModal","handleShow","handleCloseEnriched","showModalEnriched","handleShowEnriched","checkError","data","error","object","value","handleFormSubmit","e","preventDefault","cvData","lang","language","fire","title","text","type","confirmButtonColor","heightAuto","confirmButtonText","post","then","resp","jsonPath","anchorHiddenRef","click","catch","console","log","handlePDFgeneration","handleShowPDF","designNumber","pdfPath","showPDF","cv","handleShowPDFEnriched","renderPDF","border","borderRadius","createRef","render","alignItems","marginTop","justifyContent","marginLeft","showSpinner","mapStateToProps","utility"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Row, Col } from \"react-bootstrap\";\nimport CustomButton from \"../../core/CustomButton\";\nimport SubmitModal from \"./Modals/Submit/SubmitModal\";\nimport { toggleSpinner, updateError } from \"../../../actions/utilityActions\";\nimport Spinner from \"../../../components/core/Spinner\";\nimport { connect } from \"react-redux\";\nimport Swal from \"sweetalert2\";\nimport axios from \"axios\";\nimport { trackPromise } from \"react-promise-tracker\";\nimport {\n  warningLabel,\n  warningText,\n  submitTitle,\n  submitFirstButtonLabel,\n  submitSecondButtonLabel,\n  submitThirdButtonLabel,\n  submitFourthButtonLabel\n} from \"../../../translations/translations\";\n\nclass FormSubmit extends Component {\n  constructor(props) {\n    super(props);\n    // Create the ref\n    this.anchorHiddenRef = React.createRef();\n    this.state = {\n      showModal: false,\n      showModalEnriched: false,\n      key: 0,\n      showPDF: false,\n      pdfPath: \"\",\n      jsonPath: \"\"\n    };\n  }\n\n  handleClose = () => {\n    let key = this.state.key;\n    this.setState({ showModal: false, key: ++key });\n  };\n\n  handleShow = () => {\n    let key = this.state.key;\n    this.setState({ showModal: true, key: ++key });\n  };\n\n  handleCloseEnriched = () => {\n    let key = this.state.key;\n    this.setState({ showModalEnriched: false, key: ++key });\n  };\n\n  handleShowEnriched = () => {\n    let key = this.state.key;\n    this.setState({ showModalEnriched: true, key: ++key });\n  };\n\n  checkError = data => {\n    let error = false;\n    if (data[\"my0:aboutPerson\"][\"my0:firstName\"] === \"\") {\n      this.props.updateError({\n        object: \"my0:firstName\",\n        value: true\n      });\n      error = true;\n    }\n    if (data[\"my0:aboutPerson\"][\"my0:lastName\"] === \"\") {\n      this.props.updateError({\n        object: \"my0:lastName\",\n        value: true\n      });\n      error = true;\n    }\n    if (data[\"my0:aboutPerson\"][\"my0:email\"] === \"\") {\n      this.props.updateError({\n        object: \"my0:email\",\n        value: true\n      });\n      error = true;\n    }\n    return error;\n  };\n\n  handleFormSubmit = async e => {\n    e.preventDefault();\n    if (this.checkError(this.props.cvData)) {\n      let lang = this.props.language;\n      Swal.fire({\n        title: warningLabel[lang],\n        text: warningText[lang],\n        type: \"warning\",\n        confirmButtonColor: \"#4bb3cc\",\n        heightAuto: false,\n        confirmButtonText: \"Okay\"\n      });\n    } else {\n      axios\n        .post(\"/submit_form\", this.props.cvData)\n        .then(resp => {\n          this.setState({\n            jsonPath: \"../../static/\" + resp.data\n          });\n          this.anchorHiddenRef.click();\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    }\n  };\n\n  handlePDFgeneration = e => {\n    e.preventDefault();\n    this.handleShow();\n  };\n\n  handleShowPDF = async (designNumber, language) => {\n    if (this.checkError(this.props.cvData)) {\n      let lang = this.props.language;\n      Swal.fire({\n        title: warningLabel[lang],\n        text: warningText[lang],\n        type: \"warning\",\n        confirmButtonColor: \"#4bb3cc\",\n        heightAuto: false,\n        confirmButtonText: \"Okay\"\n      });\n    } else {\n      this.setState({\n        pdfPath: \"\"\n      });\n      this.setState({\n        showPDF: false\n      });\n      this.handleClose();\n      trackPromise(\n        axios\n          .post(\"/generate_pdf\", {\n            data: {\n              cv: this.props.cvData,\n              designNumber: designNumber,\n              language: language\n            }\n          })\n          .then(resp => {\n            this.setState({\n              pdfPath: \"../../\" + resp.data\n            });\n            this.setState({\n              showPDF: true\n            });\n          })\n          .catch(error => {\n            console.log(error);\n          })\n      );\n    }\n  };\n\n  handleShowPDFEnriched = async (designNumber, language) => {\n    if (this.checkError(this.props.cvData)) {\n      let lang = this.props.language;\n      Swal.fire({\n        title: warningLabel[lang],\n        text: warningText[lang],\n        type: \"warning\",\n        confirmButtonColor: \"#4bb3cc\",\n        heightAuto: false,\n        confirmButtonText: \"Okay\"\n      });\n    } else {\n      this.setState({\n        pdfPath: \"\"\n      });\n      this.setState({\n        showPDF: false\n      });\n      this.handleCloseEnriched();\n      trackPromise(\n        axios\n          .post(\"/generate_pdf_enriched\", {\n            data: {\n              cv: this.props.cvData,\n              designNumber: designNumber,\n              language: language\n            }\n          })\n          .then(resp => {\n            this.setState({\n              pdfPath: \"../../\" + resp.data\n            });\n            this.setState({\n              showPDF: true\n            });\n          })\n          .catch(error => {\n            console.log(error);\n          })\n      );\n    }\n  };\n\n  renderPDF = () => {\n    if (this.state.showPDF) {\n      return (\n        <embed\n          style={{ border: \"3px solid #4bb3cc\", borderRadius: \"5px\" }}\n          src={this.state.pdfPath + \".pdf\"}\n          width=\"800px\"\n          height=\"900px\"\n        />\n      );\n    } else {\n      return \"\";\n    }\n  };\n\n  render() {\n    let showModal = this.state.showModal;\n\n    let lang = this.props.language;\n\n    return (\n      <React.Fragment>\n        <Row style={{ alignItems: \"flex-start\" }}>\n          <Col md={4}>\n            <h4 style={{ marginTop: \"10px\" }}>{submitTitle[lang]}</h4>\n            <Row style={{ justifyContent: \"left\", marginLeft: 0 }}>\n              <CustomButton\n                label={submitFirstButtonLabel[lang]}\n                classnames=\"final-submit\"\n                handleClick={this.handleFormSubmit}\n              />\n              <a\n                ref={anchorHiddenRef =>\n                  (this.anchorHiddenRef = anchorHiddenRef)\n                }\n                href={this.state.jsonPath}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                download\n                hidden\n              >\n                {\" \"}\n              </a>\n            </Row>\n            <Row style={{ justifyContent: \"left\", marginLeft: 0 }}>\n              <CustomButton\n                label={submitSecondButtonLabel[lang]}\n                classnames=\"final-submit\"\n                handleClick={this.handleShow}\n              />\n            </Row>\n            <SubmitModal\n              showPdf={this.handleShowPDF}\n              show={showModal}\n              key={this.state.key}\n              onHide={this.handleClose}\n            />\n            <Row style={{ justifyContent: \"left\", marginLeft: 0 }}>\n              <CustomButton\n                label={submitThirdButtonLabel[lang]}\n                classnames=\"final-submit\"\n                handleClick={this.handleShowEnriched}\n              />\n              <SubmitModal\n                showPdf={this.handleShowPDFEnriched}\n                show={this.state.showModalEnriched}\n                key={this.state.key}\n                onHide={this.handleCloseEnriched}\n              />\n            </Row>\n            <Row style={{ justifyContent: \"left\", marginLeft: 0 }}>\n              {this.state.showPDF ? (\n                <a\n                  className=\"final-submit btn btn-primary\"\n                  style={{ marginTop: \"150px\" }}\n                  href={this.state.pdfPath + \".tex\"}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  download\n                >\n                  {submitFourthButtonLabel[lang]}\n                </a>\n              ) : (\n                \"\"\n              )}\n            </Row>\n          </Col>\n          <Col md={8}>{this.renderPDF()}</Col>\n        </Row>\n        <Row\n          style={{\n            justifyContent: \"left\",\n            marginTop: \"10px\",\n            marginLeft: \"5px\"\n          }}\n        >\n          <Spinner show={this.props.showSpinner} />\n        </Row>\n      </React.Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    cvData: state.cv,\n    language: state.utility.language,\n    showSpinner: state.utility.showSpinner,\n    error: state.utility.error\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  {\n    toggleSpinner,\n    updateError\n  }\n)(FormSubmit);\n"]},"metadata":{},"sourceType":"module"}